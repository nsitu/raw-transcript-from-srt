<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
<title>Raw Transcript Generator</title>
<script language = "JavaScript">


function clearTimestamps(srt){
  var lines = srt.split("\n");
  var output = [];
  lines.forEach(function(v,i,a){
    /* Include text if it's not too short and isn't a timestamp and isn't a number. */
    if (v.length > 1 && !v.includes("-->") && isNaN(v) ){
      /* remove several types of new line characters */
      output.push(v.replace(/(\r\n|\n|\r)/gm,""));
    }
  });
  return output.join(' ');
}



</script>
<style>
body{
  font-family: arial, helvetica, sans-serif;
  text-align: center;

}
#holder { border: 10px dashed #ccc; width: 140px; height: 100px; padding: 100px 80px 40px 80px; margin: 20px auto; color: #aaa; }
#holder.hover { border: 10px dashed #333; }

p{
  width: 60%;
  margin: 30px auto ;
}

#output{
  width: 60%;
  margin: 30px auto ;
  text-align: left;
  padding: 30px;
}
 .finished{

   border: 5px solid #ccc;
 }
  </style>

</head>
<body>
    <h1>Raw Transcript Generator</h1>
    <p>This tool removes timestamps and spacing from SRT files. My use case was to clean up autogenerated YouTube captions.</p>


    <div id="holder">File API & FileReader API not supported</div>

    <div id="output"></div>



<script>

  // modified from http://html5demos.com/file-api
  var holder = document.getElementById('holder');
  var output = document.getElementById('output');


  if (typeof window.FileReader === 'undefined') {
      holder.className = 'fail';
  } else {
      holder.className = 'success';
      holder.innerHTML = 'Drag and drop an .srt file here.';
  }

  holder.ondragover = function() {
      this.className = 'hover';
      return false;
  };
  holder.ondragend = function() {
      this.className = '';
      return false;
  };
  holder.ondrop = function(e) {
      this.className = '';
      e.preventDefault();

      var file = e.dataTransfer.files[0],
      reader = new FileReader();
      reader.onload = function(event) {
          console.log(event.target);
          output.className = 'finished';
          output.innerText = clearTimestamps(event.target.result);
      };
      console.log(file);
      reader.readAsText(file);

      return false;
  };
  </script>

<p>Created by <a href="https://nsitu.ca/">Harold Sikkema</a>.
  <br/>HTML5 drag-and-drop by <a href="http://jsfiddle.net/jimschubert/DqcUg/">jimschubert</a>
  <br/>Inspired by <a href="https://anatolt.ru/t/del-timestamp-srt.html">anatolt.ru</a>.
  </p>
</body>
</html>
